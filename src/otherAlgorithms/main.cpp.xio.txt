// xio

#include "../lib/hardware/INS/INS.hpp"
#include "../lib/algorithms/xio-technologies/xio-madgwickAHRS.hpp"


XioMadgwick xioMadgwick;


void setup() {
  setupHardware();
}

void loop() {
  // get data from sensors
  IMUdata imuRawValues = readSensors();
  String rawDataStr = formatIMUvalues(imuRawValues);
  

  
  // calculate attitude using xioMadgwick algorithm
  xioMadgwick.madgwickAHRSupdate(imuRawValues.getGyroscopes().x, imuRawValues.getGyroscopes().y, imuRawValues.getGyroscopes().z, 
                                 imuRawValues.getAccelerometers().x, imuRawValues.getAccelerometers().y, imuRawValues.getAccelerometers().z, 
                                 imuRawValues.getMagnetometers().x, imuRawValues.getMagnetometers().y, imuRawValues.getMagnetometers().z);
  xioMadgwick.quaternionToEuler();
  Attitude currentAttitudeRawDegrees = fillAttitudeValues(xioMadgwick.pitch, xioMadgwick.roll, xioMadgwick.yaw);
  String pitchAndRollRawDegreesStr = formatPitchandRoll(currentAttitudeRawDegrees);
  Serial.println(pitchAndRollRawDegreesStr);
} 